generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Transportadora {
  id                   Int                 @id @default(autoincrement())
  razaoSocial          String
  cnpj                 String              @unique
  uf                   String              @db.VarChar(2)   
  tiposProduto         String[]            @default([])     
  quimicosControlados  Boolean             @default(false)
  disponivelParaFrete  Boolean?            // se existir; senão pode remover
  registros            RegistroDocumento[]
  createdAt            DateTime            @default(now())
  updatedAt            DateTime            @updatedAt
}


model Documento {
  id                    Int      @id @default(autoincrement())
  nome                  String   @unique
  diasAntecedenciaAviso Int      @default(7)   // RF005/RN04
  obrigatorio           Boolean  @default(true)
  registros             RegistroDocumento[]
}

model RegistroDocumento {
  id               Int            @id @default(autoincrement())
  transportadoraId Int
  documentoId      Int
  numero           String?
  emissao          DateTime?
  validade         DateTime
  arquivoUrl       String?
  ativo            Boolean        @default(true) // RN01: somente um “ativo” por par

  transportadora   Transportadora @relation(fields: [transportadoraId], references: [id])
  documento        Documento      @relation(fields: [documentoId], references: [id])

  @@index([transportadoraId, documentoId, validade])
}